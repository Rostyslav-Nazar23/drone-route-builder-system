# Drone Route Builder System

Система планування маршрутів літальних дронів

## Опис

Система для планування маршрутів літальних дронів з підтримкою:
- Планування маршрутів для одного або кількох дронів
- Алгоритми пошуку шляху (A*)
- Валідація маршрутів (no-fly зони, висота, енергія)
- Візуалізація на інтерактивній карті
- Експорт у формат .plan та JSON

## Встановлення

1. Створіть віртуальне середовище:
```bash
python -m venv venv
source venv/bin/activate  # Linux/Mac
# або
venv\Scripts\activate  # Windows
```

2. Встановіть залежності:
```bash
pip install -r requirements.txt
```

3. (Опційно) Налаштуйте PostgreSQL/PostGIS:
```bash
# Встановіть PostgreSQL з PostGIS розширенням
# Створіть базу даних:
createdb drone_routes
psql -d drone_routes -c "CREATE EXTENSION postgis;"

# Або встановіть через Docker:
docker run --name postgis -e POSTGRES_PASSWORD=postgres -p 5432:5432 -d postgis/postgis
```

Встановіть змінну оточення для підключення до БД (опційно):
```bash
export DATABASE_URL="postgresql://postgres:postgres@localhost:5432/drone_routes"
```

## Запуск

### Streamlit UI (рекомендовано)
```bash
streamlit run app/streamlit_app.py
```

Відкрийте браузер за адресою http://localhost:8501

### FastAPI Backend
```bash
uvicorn app.main:app --reload
```

API документація доступна за адресою http://localhost:8000/docs

## Використання

### Через Streamlit UI

1. Відкрийте Streamlit додаток
2. Налаштуйте параметри дрона в бічній панелі
3. Додайте цільові точки (вручну або імпортуйте з файлу)
4. Налаштуйте депо (стартову точку)
5. Натисніть "Plan Route" для планування маршруту
6. Перегляньте результат на карті
7. Експортуйте маршрут у формат .plan або JSON

### Імпорт даних

Підтримуються формати:
- **CSV**: колонки latitude, longitude, altitude, name
- **GeoJSON**: Point features для waypoints, Polygon/MultiPolygon для no-fly зон

### Експорт

- **.plan**: формат QGroundControl для імпорту в автопілот
- **JSON**: структурований формат для подальшої обробки

## Структура проєкту

```
app/
├── domain/          # Доменні моделі (Mission, Drone, Route, Waypoint)
├── data_import/     # Імпорт даних (CSV, GeoJSON)
├── environment/      # Навігаційний граф та модель вартості
├── planning/        # Алгоритми планування (A*, Theta*, D*)
├── optimization/    # Оптимізація (VRP, генетичні алгоритми)
├── validation/      # Валідація маршрутів (включаючи кінематику)
├── visualization/   # Візуалізація на карті (включаючи погоду)
├── export/          # Експорт маршрутів
├── weather/         # Інтеграція метеоданих
├── persistence/     # PostgreSQL/PostGIS підтримка
├── api/             # FastAPI endpoints
├── orchestrator/    # Координація планування
├── main.py          # FastAPI додаток
└── streamlit_app.py # Streamlit UI
```

## Функціональність

### Планування
- **Алгоритми пошуку шляху:**
  - A* - стандартний алгоритм
  - Theta* - any-angle pathfinding (більш плавні маршрути)
  - D* - dynamic replanning (підтримка змін у реальному часі)
- Підтримка grid-based та waypoint-based графів
- Урахування обмежень дрона (висота, швидкість, батарея)
- **VRP (Vehicle Routing Problem)** - оптимальний розподіл цільових точок між дронами
- **Генетичні алгоритми** - оптимізація маршрутів для мінімізації відстані та енергії
- **Інтеграція метеоданих (Open Meteo API)**
  - Врахування вітру при розрахунку вартості маршруту
  - Перевірка безпеки польоту за погодними умовами
  - Оптимізація маршруту з урахуванням вітру (попутний/зустрічний)

### Валідація
- Перевірка no-fly зон
- Перевірка висотних обмежень
- Перевірка енергетичних витрат
- **Перевірка кінематичних обмежень (Dubins Airplane)**
  - Мінімальний радіус повороту
  - Максимальна швидкість підйому/спуску
  - Перевірка здійсненності маневрів

### Візуалізація
- Інтерактивна карта з маршрутами
- Відображення waypoints, депо, no-fly зон
- **Розширена візуалізація погоди:**
  - Маркери погоди з кольоровим кодуванням (зелений/помаранчевий/червоний)
  - Стрілки напрямку вітру
  - Детальна інформація про погодні умови (вітер, температура, опади, хмарність)
- Метрики маршруту

## Розробка

Система реалізована модульно з чітким розділенням відповідальності:
- Доменна модель незалежна від UI
- Алгоритми планування можуть використовуватися окремо
- Валідація та візуалізація - окремі модулі
- Theta* та D* алгоритми
- VRP для мультидронових місій
- Генетичні алгоритми оптимізації
- Підтримка PostgreSQL/PostGIS
- Dubins Airplane для кінематичних обмежень
- Розширена візуалізація погодних умов на карті

## Ліцензія

Проєкт створено для магістерської роботи.

